---
title: "Markdown"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

# Load Libraries
```{r}
library(haven)
library(dplyr)
library(tidyr)
library(ggplot2)
```
 


## Load data
```{r}


allPatients = file.path("../","All_Data_Patientstudy.sav")
allDataPDGroups = file.path("../", "All_Data_PD_GroupPatientstudy.sav")

allDataPatientStudyDS = read_sav(allPatients)
allDataPDGroupsStudyDS = read_sav(allDataPDGroups)

```


## First glimpse
```{r}
glimpse(allDataPatientStudyDS)
glimpse(allDataPDGroupsStudyDS)
```
```{r}
variable.names(allDataPatientStudyDS)
```

```{r}
#Table 1 recreated using allDataPDGroupsStudyDS dataframe
Table1_allDataPDGroups <- allDataPDGroupsStudyDS %>%
select("Age", "Medication", "Length_Parkinson","H_Y")

Table1_allDataPDGroups
skimr::skim(Table1_allDataPDGroups)
```
```{r}
#Table 1 recreated using allDataPatientStudyDS dataframe
Table1_AllDataPatient <- allDataPatientStudyDS %>%
  filter(Group == "1")%>%
select("Group","Age", "Medication", "Length_Parkinson","H_Y")


Table1_AllDataPatient
skimr::skim(Table1_AllDataPatient)
```



```{r}
#Table 3 using allDataPatientStudyDS

Table2_AllDataPatient <- allDataPatientStudyDS %>%
  group_by(Group)%>%
select("Age", "Sex", "Handedness","MMSE","RAVEN")

Table2_AllDataPatient
skimr::skim(Table2_AllDataPatient)

Table2_AllDataPatient%>%
  group_by(Group)%>%
  count(Sex=="1")


  


```

```{r}
#Table 4 using allDataPatientStudyDS
Table3_AllDataPatient <- allDataPatientStudyDS %>%
  group_by(Group)%>%
select("Phonologic_Fluency","Semantic_Fluency","BNT", "SyllSec_Norm", "SyllSec_Ruis", "NPro_Dur_Norm","NPro_Dur_Ruis")
Table3_AllDataPatient
skimr::skim(Table3_AllDataPatient)

```


```{r}
#Table 9 using allDataPatientStudyDS
Table9_AllDataPatient <- allDataPatientStudyDS %>%
 group_by(Group)%>%
mutate(total_Nrm_reformulation = sum(Nrm_Reformulation),total_Nrm_Filled_Pause = sum(Nrm_FilledPause),total_Nrm_Repetition = sum(Nrm_Repetition),total_Nois_reformulation = sum(Nois_Reformulation), total_Nois_FilledPause = sum(Nois_FilledPause), total_Nois_Repetition = sum(Nois_Repetition))%>%
select("total_Nrm_reformulation","total_Nrm_Filled_Pause","total_Nrm_Repetition","total_Nois_reformulation","total_Nois_FilledPause","total_Nois_Repetition")
Table9_AllDataPatient

```


```{r}
Fig1_table <- allDataPatientStudyDS %>% 
  group_by(Group)%>% 
  select("Nrm_Sem_Rep", "Norm_ErrorsRepaired", "TotalErrorsNorm_N", "Nois_Sem_Rep","Noise_ErrorsRepaired", "TotalErrorsNois_N") %>%
  mutate(Total_Nrm_Sem_Rep=sum(Nrm_Sem_Rep), Total_Norm_ErrorsRepaired=sum(Norm_ErrorsRepaired), Total_TotalErrorsNorm_N = sum(TotalErrorsNorm_N), perc_Nrm_Sem_Rep = Total_Nrm_Sem_Rep / Total_TotalErrorsNorm_N, perc_Nrm_Total_Rep = Total_Norm_ErrorsRepaired/Total_TotalErrorsNorm_N,Total_Nois_Sem_Rep = sum(Nois_Sem_Rep),Total_Noise_ErrorsRepaired=sum(Noise_ErrorsRepaired),Total_TotalErrorsNois_N = sum(TotalErrorsNois_N), perc_Nois_Sem_Rep = Total_Nois_Sem_Rep / Total_TotalErrorsNois_N, perc_Nois_Total_Rep = Total_Noise_ErrorsRepaired/Total_TotalErrorsNois_N) 
Fig1_table 


  
```





