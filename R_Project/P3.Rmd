---
title: "Markdown"
author: "Meena Mishra, Raphael Kirchgaessner, Brian Karlberg"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

# Load Libraries
```{r}
library(haven)
library(dplyr)
library(tidyr)
library(ggplot2)
library(skimr)
```
 
# Discussion of Issues

The first issue we encountered was that the code for most of the variables were not familiar to us as we are not Parkinson's experts. The way we resolved this issue was by trial and error methods to determine what variables went into which tables.

Another issue with the data is that sex is coded as either a one or zero (bolean value). We attempted to diagnose this by searching the paper for gender and sex however there was no immediate explanation. Next, we downloaded the supplementary files from the original version of the paper online. In the supplementary S1, gender appears to be coded as "m" or "v" which further complicates the issue of variable naming inconsistency. There may be a bias on gender because there more than triple males in the study group and more than double the number of males in the control. Also, the sample sizes are well under 30 thus are too small.

The paper does comment that data that varied more than 2 SD from the mean for a particular condition being measured were removed from analysis. The percentatge of data loss has been reported for each condition being measured. However we are skeptical how that could change the overall analysis.

There is a potential geographic bias based on differences on the regional selection of the study and population within Belgium that is neither confirmed or denied. This is not resolvable, however this does not affect our ability to replicate the downstream analysis.


## Load data
```{r}

allPatients = file.path("../","All_Data_Patientstudy.sav")
allDataPDGroups = file.path("../", "All_Data_PD_GroupPatientstudy.sav")

allDataPatientStudyDS = read_sav(allPatients)
allDataPDGroupsStudyDS = read_sav(allDataPDGroups)

```


## First glimpse
```{r}
glimpse(allDataPatientStudyDS)
glimpse(allDataPDGroupsStudyDS)
```
```{r}
variable.names(allDataPatientStudyDS)
```

```{r}

patientStudy <- allDataPatientStudyDS %>%
  select("Subject", "Group", "Age", "Length_Parkinson", "Medication", "H_Y","Sex", "Handedness", "MMSE","RAVEN", "Phonologic_Fluency", "Semantic_Fluency", "BNT", "SyllSec_Norm", "SyllSec_Ruis", "NPro_Dur_Norm", "NPro_Dur_Ruis", "Nrm_Reformulation", "Nrm_FilledPause", "Nrm_Repetition", "DisfluenciesNorm", "Nois_Reformulation", "Nois_FilledPause", "Nois_Repetition", "DisfluenciesNoise", "Nrm_Sem_Unrep", "Nrm_Sem_Rep", "SemErrors_Norm", "Nrm_Phon_Unrep", "Nrm_Phon_Rep", "PhonErrors_Norm", "Nrm_Gram_Unrep", "Nrm_Gram_Rep", "GramErrors_Norm", "Norm_ErrorsUnrepaired", "Norm_ErrorsRepaired", "TotalErrorsNorm_N", "Nois_Sem_Unrep", "Nois_Sem_Rep", "SemErrors_Noise", "Nois_Phon_Unrep", "Nois_Phon_Rep", "PhonErrors_Nois", "Nois_Gram_Unrep", "Nois_Gram_Rep", "GramErrors_Nois", "Noise_ErrorsUnrepaired", "Noise_ErrorsRepaired", "TotalErrorsNois_N", "Norm_ErrorsRepaired_ExDisf", "TotalErrorsNormal_exDisf", "Noise_ErrorsRepaired_ExDisf", "TotalErrorsNoise_exDisf")

groupStudy <- allDataPDGroupsStudyDS %>%
select("Age", "Medication", "Length_Parkinson","H_Y", "Sex", "Handedness", "MMSE", "RAVEN", "Phonologic_Fluency", "BNT", "SyllSec_Norm", "SyllSec_Ruis", "NPro_Dur_Norm", "NPro_Dur_Ruis", "Nrm_Reformulation", "Nrm_FilledPause", "Nrm_Repetition", "DisfluenciesNorm", "Nois_Reformulation", "Nois_FilledPause", "Nois_Repetition", "DisfluenciesNoise", "Nrm_Sem_Unrep", "Nrm_Sem_Rep", "SemErrors_Norm", "Nrm_Phon_Unrep", "Nrm_Phon_Rep", "PhonErrors_Norm", "Nrm_Gram_Unrep", "Nrm_Gram_Rep", "GramErrors_Norm", "Norm_ErrorsUnrepaired", "Norm_ErrorsRepaired", "TotalErrorsNorm_N", "Nois_Sem_Unrep", "Nois_Sem_Rep", "SemErrors_Noise", "Nois_Phon_Unrep", "Nois_Phon_Rep", "PhonErrors_Nois", "Nois_Gram_Unrep", "Nois_Gram_Rep", "GramErrors_Nois", "Noise_ErrorsUnrepaired", "Noise_ErrorsRepaired", "TotalErrorsNois_N", "Norm_ErrorsRepaired_ExDisf", "TotalErrorsNormal_exDisf", "Noise_ErrorsRepaired_ExDisf", "TotalErrorsNoise_exDisf")
```

```{r}
patientStudy %>%
  group_by(Sex) %>%
  skim()
```

We have determined from this inspection that zero is male and one is female in the boolean binary.

Comparing MMSE, there are zero values missing for males and females, the mean is 27.04 for males and 27.89 for females. The standard deviation is 2.39 and 1.62. 
Having a look at the age of the participants, the average for male participants were 64.8, whereas the average for female participants were 65.56.

```{r}
patientStudy %>%
  select(- "Sex", - "H_Y", - "Handedness") %>% 
  cor()
```

With increase in age, there is a corresponding of Parkinson's length which makes sense and is expected. This is distict from occurance of Parkinson's.

Additionally, we see that patieant with longer length of Parkison's receive a higher dose of medication. This  a strong correlation of .66.

There is a negative correlation of -.33 of the mini mental metal state examination (MMSE) with each increase in unit of Parkinson's length.



```{r}
patientStudy %>%
group_by("Subject")
```

In this grouping, the "Handedness" characteristic shows values that are not 100 which is not intuitve. Further, background research (Edinburogh Handedness Study, Wikipedia)


```{r}
ggplot(patientStudy, aes(x=Age, y=Length_Parkinson)) +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle("Age vs. Parkinson length") +
  labs(x= "Age in years" , y="Length in years of Parkinsons")
```

```{r}
ggplot(patientStudy, aes(x=Age)) +
  geom_histogram() +
  ggtitle("Age") +
  labs(x= "Age in years") +
  facet_wrap(~ Sex)
```
The above plot shows how many subjects for female and male have participanted in the study.

```{r}
ggplot(patientStudy, aes(x=Age, y=Length_Parkinson)) +
  geom_point() +
  ggtitle("Controls vs. Parkinsons") +
  labs(x= "Age in years") +
  facet_wrap(~ Group)
```

This clearly shows with this plot that the control is not affected by Parkinson's while the Parkinson's group has a wide variation of length of disease expression. It is interesting to see that there is at least one person under 50 but has had Parkinson's for 20 years.

```{r}
ggplot(patientStudy, aes(x=Group, y=Nrm_Reformulation)) +
  geom_boxplot() +
  ggtitle("Reformulation by Group") +
  labs(x= "Group", y="Reformulate") +
  facet_wrap(~ Group)
```

```{r}
ggplot(patientStudy, aes(x=Group, y=Nrm_FilledPause)) +
  geom_boxplot() +
  ggtitle("Filled Pause by Group") +
  labs(x= "Group", y="Filled Pause") +
  facet_wrap(~ Group)
```

Bullet 4 - Discussion of data that may the replication of paper figures (include missing data). The above two box plots show representative distribution and variation of differing language response variables based on disease status of the two groups. There are some N/As but these can be identified and removed if needed. It is important to know in working with the data in general that 1 is for Parkinson's and 0 is for control. We want to change the Group data type to factor from double for the purpose of cleaner plots.

