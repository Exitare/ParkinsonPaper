---
title: "Markdown"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

# Load Libraries
```{r}
library(haven)
library(dplyr)
library(tidyr)
library(ggplot2)
```
 


## Load data
```{r}

allPatients = file.path("../","All_Data_Patientstudy.sav")
allDataPatientStudyDS = read_sav(allPatients)

tidied_dataset = read.csv("tidied-dataset.csv")

```

```{r}
glimpse(tidied_dataset)
```


## First glimpse
```{r}
glimpse(allDataPatientStudyDS)

```
```{r}
variable.names(allDataPatientStudyDS)
```
```{r}
allDataPatientStudyDS %>%
mutate(Sex = factor(Sex, labels = c("Female", "Male")),Group = factor(Group, labels = c("PD", "Control")))


```
```{r}
tidied_dataset <- tidied_dataset %>%
mutate(Sex = factor(Sex, labels = c("Male", "Female")),Group = factor(Group, labels = c("Control", "PD")))
```
```{r}
#Table 1 recreated using allDataPatientStudyDS dataframe
Table1 <- tidied_dataset %>%
  filter(Group == "PD")%>%
select("Group","Age", "Medication", "Length_Parkinson","H_Y")


Table1
skimr::skim(Table1)
```


```{r}
#Table 3 using tidied_dataset

Table3 <- tidied_dataset %>%
  select("Age", "Sex", "Handedness","MMSE","RAVEN","Group")%>%
  group_by(Group)%>%
  summarize(mean_age = mean(Age), mean_handedness = mean(Handedness),mean_MMSE = mean(MMSE), mean_Raven = mean(RAVEN), count = n())

Table3_count_gender <- tidied_dataset %>%
  select("Sex","Group")%>%
  group_by(Group,Sex)%>%
  summarize(count=n())

Table3
Table3_count_gender


```


```{r}
#Table 4 using tidied dataset
Table4 <- tidied_dataset %>%
  group_by(Group)%>%
select("Phonologic_Fluency","Semantic_Fluency","BNT", "SyllSec_Norm", "SyllSec_Ruis", "NPro_Dur_Norm","NPro_Dur_Ruis")%>%
  summarise(mean_Phonologic_Fluency = mean(Phonologic_Fluency), sd_phonologic_fluency = sd(Phonologic_Fluency),
            mean_Semantic_Fluency = mean(Semantic_Fluency), sd_Semantic_Fluency = sd(Semantic_Fluency),
            mean_BNT = mean(BNT), sd_BNT = sd(BNT),
            mean_Syllsec_Norm = mean(SyllSec_Norm), sd_Syllsec_Norm = sd(SyllSec_Norm),
            mean_Syllsec_Ruis = mean(SyllSec_Ruis), sd_SyllSec_Ruis = sd(SyllSec_Ruis),
            mean_NPro_Dur_Norm = mean(NPro_Dur_Norm), sd_NPro_Dur_Norm = sd(NPro_Dur_Norm),
            mean_NPro_Dur_Ruis = mean(NPro_Dur_Ruis), sd_NPro_Dur_Ruis = sd(NPro_Dur_Ruis))
Table4

```


```{r}
#Table 9 using using tidied dataset
Table9_raw <- tidied_dataset %>%
  select("Group","Nrm_Reformulation","Nrm_FilledPause","Nrm_Repetition","Nois_Reformulation","Nois_FilledPause", "Nois_Repetition")

Table9 <- Table9_raw %>%
  gather (key = "Error_type", value = "Total_Number",-Group,"Nrm_Reformulation","Nrm_FilledPause","Nrm_Repetition","Nois_Reformulation","Nois_FilledPause", "Nois_Repetition")
Table9

aggregate(Total_Number~Error_type+Group,Table9,sum)
 

```
```{r}
Fig1_raw <- allDataPatientStudyDS %>%
  select("Group","Pct_NormRep","Pct_NoiseRep","PctSemNoiseRep","PctSemNormRep")%>%
  filter(Group == 0)%>%
  summarise(mean_Pct_NormRep=mean(Pct_NormRep),mean_Pct_NoiseRep=mean(Pct_NoiseRep),mean_PctSemNoiseRep=mean(PctSemNoiseRep),mean_PctSemNormRep=mean(PctSemNormRep))
 
 
 
  
```


```{r}
Fig1_Raw_table <- allDataPatientStudyDS %>% 
  select("Group","Nrm_Sem_Rep", "Norm_ErrorsRepaired", "TotalErrorsNorm_N", "Nois_Sem_Rep","Noise_ErrorsRepaired", "TotalErrorsNois_N") 

Fig1_table <- Fig1_Raw_table %>%
  gather (key = "Error_Repaired", value = "Total_Number",-Group,"Nrm_Sem_Rep", "Norm_ErrorsRepaired", "TotalErrorsNorm_N", "Nois_Sem_Rep","Noise_ErrorsRepaired", "TotalErrorsNois_N")
Fig1_table

Fig1 <- aggregate(Total_Number~Error_Repaired+Group,Fig1_table,sum)  



#Fig1%>%
#group_by(Group)%>%
#filter(Error_Repaired == "Nrm_Sem_Rep",Error_Repaired == "TotalErrorsNorm_N") %>%
#mutate(Perc_Sem_Error_Repaired = (Nrm_Sem_Rep / TotalErrorsNorm_N) * 100)
  
  
#  mutate(Total_Nrm_Sem_Rep=sum(Nrm_Sem_Rep), Total_Norm_ErrorsRepaired=sum(Norm_ErrorsRepaired), Total_TotalErrorsNorm_N = sum(TotalErrorsNorm_N), perc_Nrm_Sem_Rep = Total_Nrm_Sem_Rep / Total_TotalErrorsNorm_N, perc_Nrm_Total_Rep = Total_Norm_ErrorsRepaired/Total_TotalErrorsNorm_N,Total_Nois_Sem_Rep = sum(Nois_Sem_Rep),Total_Noise_ErrorsRepaired=sum(Noise_ErrorsRepaired),Total_TotalErrorsNois_N = sum(TotalErrorsNois_N), perc_Nois_Sem_Rep = Total_Nois_Sem_Rep / Total_TotalErrorsNois_N, perc_Nois_Total_Rep = Total_Noise_ErrorsRepaired/Total_TotalErrorsNois_N) 
#Fig1_Raw_table 

```

```{r}
#Fig1_table<- Fig1_Raw_table %>%
  #gather (key = "Error_Repaired", value = "Total_Number_Repaired",-Group,"Nrm_Reformulation","Nrm_FilledPause","Nrm_Repetition","Nois_Reformulation","Nois_FilledPause", "Nois_Repetition")
#Table9_AllDataPatient
```

```{r}
Fig2_Raw_table <- allDataPatientStudyDS %>% 
  select("Group","DisfluenciesNorm", "DisfluenciesNoise", "SemErrors_Norm","Nrm_Sem_Rep", "SemErrors_Noise","Nois_Sem_Rep", "Norm_ErrorsRepaired","Noise_ErrorsRepaired","TotalErrorsNorm_N","TotalErrorsNois_N" ) 
Fig2_table <- Fig2_Raw_table %>%
  gather (key = "Error_Type", value = "Total_Number",-Group,"DisfluenciesNorm", "DisfluenciesNoise", "SemErrors_Norm","Nrm_Sem_Rep", "SemErrors_Noise","Nois_Sem_Rep", "Norm_ErrorsRepaired","Noise_ErrorsRepaired","TotalErrorsNorm_N","TotalErrorsNois_N")
Fig2_table

Fig2 <- aggregate(Total_Number~Error_Type+Group,Fig2_table,sum)  


```
```{r}
Fig2_table_2 <- allDataPatientStudyDS %>%
  group_by(Group)%>%
  select("SemErrors_Norm","Nrm_Sem_Rep", "SemErrors_Noise","Nois_Sem_Rep", "Norm_ErrorsRepaired","Noise_ErrorsRepaired","TotalErrorsNorm_N","TotalErrorsNois_N" )%>%
  mutate(Nrm_Perc_Sem_Error_Repaired = Nrm_Sem_Rep/SemErrors_Norm * 100, Nois_Per_Sem_Error_Repaired = Nois_Sem_Rep/SemErrors_Noise *100, Nrm_Perc_Total_Error_Rep = Norm_ErrorsRepaired/TotalErrorsNorm_N *100, Nois_Per_Total_Error_Rep = Noise_ErrorsRepaired/TotalErrorsNois_N *100)


Fig2_table_2

skimr::skim(Fig2_table_2)


```
```{r}
Final_Fig2_table_2 <- Fig2_table_2 %>%
  #filter_all(any_vars(!is.na(.))) %>%
  replace(is.na(.), 0)%>%
  group_by(Group) %>% 
  summarize(Mean_Nrm_Perc_Sem_Error_Repaired = mean(Nrm_Perc_Sem_Error_Repaired),Mean_Nois_Per_Sem_Error_Repaired = mean(Nois_Per_Sem_Error_Repaired), Mean_Nrm_Perc_Total_Error_Repaired = mean(Nrm_Perc_Total_Error_Rep),Mean_Nois_Perc_Total_Error_Repaired = mean(Nois_Per_Total_Error_Rep))

Final_Fig2_table_2   
```

# Table 10
```{r Table 10}

model <- lm(age~sex,data = allDataPatientStudyDS )

table <- allDataPatientStudyDS %>%
  select 
```



