---
title: Group 4 - P3 submission
author: "Meena Mishra, Raphael Kirchgaessner, Brian Karlberg"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

# Load Libraries
```{r}
library(tidyverse)
library(haven)
library(dplyr)
library(tidyr)
library(ggplot2)
library(skimr)
```
 
# Discussion of Issues

The first issue we encountered was that the code for most of the variables were not familiar to us as we are not Parkinson's experts. The way we resolved this issue was by trial and error and by comparing summary statistics of variables with what is reported in the paper. 

Another issue with the data is that sex is coded as either a one or zero (bolean value). We attempted to diagnose this by searching the paper for gender and sex however there was no immediate explanation. Next, we downloaded the supplementary files from the original version of the paper online. In the supplementary S1, gender appears to be coded as "m" or "v" which further complicates the issue of variable naming inconsistency. There may be a bias on gender because there more than triple males in the study group and more than double the number of males in the control. Also, the sample sizes are well under 30 and thus too small perhaps to have enough power to reject null hypothesis, in case the effect size is not large enough. 

The paper does comment that data that varied more than 2 SD from the mean for a particular condition being measured were removed from analysis. The percentatge of data loss has been reported for each condition being measured. However we are skeptical how that could change the overall analysis.

There is a potential geographic bias based on differences on the regional selection of the study and population within Belgium that is neither confirmed or denied. This is not resolvable, however this does not affect our ability to replicate the downstream analysis.

# EDA 

We followed all the exploratory data methods to look at the variables of interest. 
Looking at the raw values. â—¦dplyr::glimpse()
Computing summary statistics of the variables of interest. 
Visualizing data

##Looking at raw data

### Load data
```{r}

patientStudy <- read_csv("tidied_dataset.csv")

```
```{r, include=FALSE}

allPatients = file.path("../","All_Data_Patientstudy.sav")
allDataPDGroups = file.path("../", "All_Data_PD_GroupPatientstudy.sav")

allDataPatientStudyDS = read_sav(allPatients)
allDataPDGroupsStudyDS = read_sav(allDataPDGroups)

```


### First glimpse
A good EDA starts with a glimpse at the data or a raw view of the data. 
```{r, echo=T, results='hide'}
glimpse(allDataPatientStudyDS)
glimpse(allDataPDGroupsStudyDS)
```


```{r include=FALSE}
variable.names(allDataPatientStudyDS)
```

```{r Selecting all important variables}

patientStudy <- allDataPatientStudyDS %>%
  select("Subject", "Group", "Age", "Length_Parkinson", "Medication", "H_Y","Sex", "Handedness", "MMSE","RAVEN", "Phonologic_Fluency", "Semantic_Fluency", "BNT", "SyllSec_Norm", "SyllSec_Ruis", "NPro_Dur_Norm", "NPro_Dur_Ruis", "Nrm_Reformulation", "Nrm_FilledPause", "Nrm_Repetition", "DisfluenciesNorm", "Nois_Reformulation", "Nois_FilledPause", "Nois_Repetition", "DisfluenciesNoise", "Nrm_Sem_Unrep", "Nrm_Sem_Rep", "SemErrors_Norm", "Nrm_Phon_Unrep", "Nrm_Phon_Rep", "PhonErrors_Norm", "Nrm_Gram_Unrep", "Nrm_Gram_Rep", "GramErrors_Norm", "Norm_ErrorsUnrepaired", "Norm_ErrorsRepaired", "TotalErrorsNorm_N", "Nois_Sem_Unrep", "Nois_Sem_Rep", "SemErrors_Noise", "Nois_Phon_Unrep", "Nois_Phon_Rep", "PhonErrors_Nois", "Nois_Gram_Unrep", "Nois_Gram_Rep", "GramErrors_Nois", "Noise_ErrorsUnrepaired", "Noise_ErrorsRepaired", "TotalErrorsNois_N", "Norm_ErrorsRepaired_ExDisf", "TotalErrorsNormal_exDisf", "Noise_ErrorsRepaired_ExDisf", "TotalErrorsNoise_exDisf")

groupStudy <- allDataPDGroupsStudyDS %>%
select("Age", "Medication", "Length_Parkinson","H_Y", "Sex", "Handedness", "MMSE", "RAVEN", "Phonologic_Fluency", "BNT", "SyllSec_Norm", "SyllSec_Ruis", "NPro_Dur_Norm", "NPro_Dur_Ruis", "Nrm_Reformulation", "Nrm_FilledPause", "Nrm_Repetition", "DisfluenciesNorm", "Nois_Reformulation", "Nois_FilledPause", "Nois_Repetition", "DisfluenciesNoise", "Nrm_Sem_Unrep", "Nrm_Sem_Rep", "SemErrors_Norm", "Nrm_Phon_Unrep", "Nrm_Phon_Rep", "PhonErrors_Norm", "Nrm_Gram_Unrep", "Nrm_Gram_Rep", "GramErrors_Norm", "Norm_ErrorsUnrepaired", "Norm_ErrorsRepaired", "TotalErrorsNorm_N", "Nois_Sem_Unrep", "Nois_Sem_Rep", "SemErrors_Noise", "Nois_Phon_Unrep", "Nois_Phon_Rep", "PhonErrors_Nois", "Nois_Gram_Unrep", "Nois_Gram_Rep", "GramErrors_Nois", "Noise_ErrorsUnrepaired", "Noise_ErrorsRepaired", "TotalErrorsNois_N", "Norm_ErrorsRepaired_ExDisf", "TotalErrorsNormal_exDisf", "Noise_ErrorsRepaired_ExDisf", "TotalErrorsNoise_exDisf")
```

## Summary statistics
```{r}
patientStudy %>%
  group_by(Group) %>%
  skim()
```

_We have determined from this inspection that zero is male and one is female in the boolean binary._

### Overall Summary statistics
The data table for the study has 34 observations for 53 variables. There are 16 controls and 18 Parkinson patients in this study. Variables "Sex" and "Group" are factor variables. There are 11 males and 5 females in the control group and 14 males and 4 females in the Parkinson group. The distribution of most variables is highly skewed. There are 0 values missing for all variables except H_Y, which has 3 missing values. 

### Summary statistic for control variables
For the purpose of this study the authors considered age, gender, handedness, Mini Mental State Examination (MMSE) and Raven's progressive matrices (RAVEN) as control variabes and tried to minimize their variability between the two groups. We looked at the mean and standard deviations of these variables. Our results matched with what the authors report in the paper (Table 3, page 9/28). 

### Regarding the control variable Handedness:
Based on background research on the handedness variable, analysis can be done that either treats this variable as continuous as it is recorded in the raw data, or it can be converted to a discrete variable depending on the interpretation that we desire.

```{r}
Table3_AllDataPatient <- patientStudy %>%
  group_by(Group)%>%
select("Age", "Sex", "Handedness","MMSE","RAVEN")

skimr::skim(Table3_AllDataPatient)

Table3_AllDataPatient%>%
  group_by(Group)%>%
  count(Sex=="1")


```
### Comparing control variables between the 2 genders and 2 groups
There is a greater variation in the handedness in males (control group: males sd = 49.58; females = 4.546097) as opposed to the females. The greater variation in handedness in males is also present in the disease group.  

There is also greater variation in age in males (control group: males sd = 9.63; females = 5.31) as opposed to females in the control group. The variability in age decreases for males (sd = 8.97) and increases for females (sd = 7.37) in the disease group. 

However, the greater variability in the control variables for males is not unexected considering small sample size and the fact that there are very few females in each group.  


```{r}
(Group_gender_controlV <- patientStudy %>%
  group_by(Group,Sex)%>%
  select("Age", "Handedness","MMSE","RAVEN")%>%
  summarize(mean_age = mean(Age), sd_age = sd(Age), mean_handedness = mean(Handedness), sd_handedness = sd(Handedness), mean_MMSE = mean(MMSE), sd_MMSE = sd(MMSE), mean_raven = mean(RAVEN), sd_raven = sd(RAVEN)))


```



## Visualization
Overall small sample size results in the values of most variables being highly skewed, as is seen from skimming the data and creating additional histograms and boxplots.For highly skewed data it is worth looking at the median values of the variables as opposed to the mean. 

We created some graphs to study "Group" (Control vs Parkinson) characteristics. We created boxplots for age, length of parkinson (year), medication calculated as Levodopa equivalent and Hoehn Yahr Scale. 

Age:
The median age of males is slightly higher than females in the control group than in disease group. There are some outliers in the males in both control and disease groups.

Length of Parkinson:
The median length of Parkinson in females is lower than that in males, with both groups showing a wide variation in this variable.

H_Y:
Hoehn and Yahr scale is used to describe the symptom progression of Parkinson disease. Males in this study population have higher values for the Hoehn and Yahr scale than females. The 75th percentile H_Y score for Males is 3 as opposed to 2.5 for females. However the median H_Y scores for both males and females are the aproxomately equal (2). 

Medication:
The median Levodopa equivalent dose for males is much higher than that for females. Males also have greater variation in the medication dose than females, but this can also be due to the fact that total number of females in the study is far less than males (5 females and 11 males),


```{r}
patientStudy$Group <- as.factor( patientStudy$Group )
patientStudy$Sex <- as.factor( patientStudy$Sex )
```


```{r}
Group_characteristics <- patientStudy %>%
  select("Group","Age","Length_Parkinson","H_Y","Medication","Sex") 

ggplot(Group_characteristics,aes(x = Age,fill = Sex))+
  geom_histogram(binwidth = 5,position = "dodge")+
  facet_wrap(~Group)

ggplot(Group_characteristics,aes(x = Sex,y = Age))+
  geom_boxplot()+
  facet_wrap(~Group)

ggplot(Group_characteristics,aes(x = Sex,y = Length_Parkinson))+
  geom_boxplot()+
  facet_wrap(~Group)

ggplot(Group_characteristics,aes(x = H_Y,fill = Sex))+
  geom_histogram(binwidth = 0.5)+
  facet_wrap(~Group)

ggplot(Group_characteristics,aes(x = Sex,y = H_Y))+
  geom_boxplot()+
  facet_wrap(~Group)


ggplot(Group_characteristics,aes(x = Sex,y = Medication))+
  geom_boxplot()+
  facet_wrap(~Group)



```
### Looking at how variables correlate with each other

With increase in age, there is a corresponding increase in Parkinson's length which makes sense and is expected. This is distict from occurance of Parkinson's.

Additionally, we see that patieant with longer length of Parkison's receive a higher dose of medication. There is a strong correlation of .66.

There is a negative correlation of -.33 of the mini mental metal state examination (MMSE) with each increase in unit of Parkinson's length.

We thought it might be a good idea to check if a patient with Parkinson's has a correlation with the speech variable of length of pause. Interestingly, it is slightly negatively correlated with a value of -.2. But it is positively correlated with age. However, this might not represent the most meaningful metric because the response could be multivariate with multiple correlations.


```{r}

patientStudy%>%
  select("Age","Medication","Length_Parkinson","MMSE", "Nrm_FilledPause")%>%
cor()
```

```{r}
ggplot(patientStudy, aes(x=Age, y=Length_Parkinson)) +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle("Age vs. Parkinson length") +
  labs(x= "Age in years" , y="Length in years of Parkinsons")
```



### Looking at "Length of Parkinson" by "Age" and "Sex""

We generated scatter and boxplots to look at the variability in the length of Parkinson in the disease group. Subjects with Parkinson have a wide variation in the length of disease. It is interesting to see that there is at least one person under 50 with length of Parkinson of 20 years. The heterogeniety in the patient population with respect to the length of disease is remarkable, from 5 to almost 25 years. 


```{r}
ggplot(patientStudy, aes(x=Age, y=Length_Parkinson)) +
  geom_point() +
  ggtitle("Controls vs. Parkinsons") +
  labs(x= "Age in years") +
  facet_wrap(~ Group)
```
```{r}
library(ggbeeswarm)
patientStudy %>%
  filter(Group==1) %>%
ggplot(aes(x = Age, y = Length_Parkinson)) +
  geom_boxplot(outlier.shape = NA) +
  geom_quasirandom(fill = "lightseagreen", 
               colour = "lightseagreen") 

```

### Looking at Disfluencies between diseased and control group and exploring differences in disfluencies by sex

We explored the distribution and variation of two types of disfluencies, reformulation and filled pauses, between the disease and control group.We were curious if the differences are similar in both sexes. We would like to point out though that the number of females in the 2 groups, diseased and control, is dispropotionately low. We would like to point out that in this dataset:

Group is a factor variable
 1 = patients with Parkinson (Parkinson group) 
 0 = control

Sex is a factor variable 
0 = Male
1= Female

We see that under normal condition and under noise masking, the median value of reformulation disfluency is higher and the median value of the filled pause is lower in the diseased group when compared to the control. 
However, when we further group by sex, we see differences between the genders regarding these 2 disfluencies, reformulation and filled pause, under the two different conditions, normal and noise masking. WE see that while the males follow the overall trend seen at "Group" (disease vs control) level, female diseased subjects under noise masking show differing trend. Female diseased subjects have lower median value of reformulation and higher median value of filled pauses than the control. This is an interesting trend which warrants further exploration. The differences in disfluencies between the genders may not emerge as a significant finding due to the small sample size of females in this study.  

```{r}
ggplot(patientStudy, aes(x=Group, y=Nrm_Reformulation)) +
  geom_boxplot() +
  ggtitle("Reformulation by Group under Normal Condition") +
  labs(x= "Group", y="Reformulate") 
 

ggplot(patientStudy, aes(x=Group, y=Nrm_Reformulation)) +
  geom_boxplot() +
  ggtitle("Reformulation by Group and Sex under Normal Condition") +
  labs(x= "Group", y="Reformulate") +
  facet_wrap(~ Sex)

ggplot(patientStudy, aes(x=Group, y=Nois_Reformulation)) +
  geom_boxplot() +
  ggtitle("Reformulation by Group under Noise Masking") +
  labs(x= "Group", y="Reformulate") 

ggplot(patientStudy, aes(x=Group, y=Nois_Reformulation)) +
  geom_boxplot() +
  ggtitle("Reformulation by Group and Sex under Noise Masking") +
  labs(x= "Group", y="Reformulate") +
  facet_wrap(~ Sex)
```


```{r}
ggplot(patientStudy, aes(x=Group, y=Nrm_FilledPause)) +
  geom_boxplot() + 
  ggtitle("Filled Pause by Group under Normal Condition") +
  labs(x= "Group", y="Filled Pause")

ggplot(patientStudy, aes(x=Group, y=Nrm_FilledPause)) +
  geom_boxplot() + 
  ggtitle("Filled Pause by Group and Sex under Normal Condition ") +
  labs(x= "Group", y="Filled Pause")+
  facet_wrap(~ Sex)

ggplot(patientStudy, aes(x=Group, y=Nois_FilledPause)) +
  geom_boxplot() + 
  ggtitle("Filled Pause by Group under Noise Masking") +
  labs(x= "Group", y="Filled Pause")

ggplot(patientStudy, aes(x=Group, y=Nois_FilledPause)) +
  geom_boxplot() + 
  ggtitle("Filled Pause by Group and Sex under Noise Masking") +
  labs(x= "Group", y="Filled Pause")+
  facet_wrap(~ Sex)
  
```

# Overall Impression 
From the intial EDA we discovered that the distributions of most variables are highly skewed. This could be due to the small sample size. There are several N/As for some of the variables but these can be identified and removed if needed.  We did not encounter any major problems during our initial data exploration. Sumnmary statistics of all control variables matched with what the authors have reported. Small sample size and skewed distribution of variables make us wonder if we can draw any meanigful inference from the overall analysis. Also, we fear that any meanigful differences between genders may not emerge due to the small sample size of females in this study. 
